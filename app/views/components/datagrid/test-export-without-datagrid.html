<div class="row">
  <div class="twelve columns">
    <br />
    <h3>Grid Example: Core</h3>
    <p>
    Shows how to expose the export to excel functionality in a toolbar button and use it without initializing a datagrid.
    </p>
    <hr class="fieldset-hr"/>
  </div>
</div>

<div class="row">
  <div class="twelve columns">

    <div class="toolbar" role="toolbar">
      <div class="title">
        Compressors
        <span class="datagrid-result-count">(10 Results)</span>
      </div>
      <div class="buttonset">
        <button type="button" class="btn" id="export">
          <svg class="icon" focusable="false" aria-hidden="true" role="presentation">
            <use href="#icon-export-spreadsheet"></use>
          </svg>
          <span>Export</span>
        </button>
      </div>

      <div class="more">
        <button type="button" class="btn-actions">
          <svg class="icon" focusable="false" aria-hidden="true" role="presentation">
            <use href="#icon-more"></use>
          </svg>
          <span class="audible">More Actions</span>
        </button>
        <ul class="popupmenu">
          <li><a data-option="personalize-columns" href="#">Personalize Columns</a></li>
          <li><a data-option="reset-layout" href="#">Reset to Default</a></li>
          <li class="separator"></li>
          <li class="heading">Row Height</li>
          <li class="is-selectable"><a data-option="row-extra-small" href="#" data-translate="text">ExtraSmall</a></li>
          <li class="is-selectable"><a data-option="row-small" href="#" data-translate="text">Small</a></li>
          <li class="is-selectable"><a data-option="row-medium" href="#" data-translate="text">Medium</a></li>
          <li class="is-selectable is-checked"><a data-option="row-large" href="#" data-translate="text">Large</a></li>
        </ul>
      </div>
    </div>

  </div>
</div>

<script>
  $('body').one('initialized', function () {
    $('#export').on('click', function () {

      var url = '{{basepath}}api/tasks';
      $.getJSON(url, function(res) {
        res.splice(0, 0, {id: ' ID', escalated: 'Escalated', taskName: 'Task Name', desc: 'Description', comments: 'Comments'})
        Soho.excel.exportToExcel('MyExport', 'Worksheet1', res);
        // Soho.excel.exportToCsv('MyExport', res);
      });

    });
 });
</script>
