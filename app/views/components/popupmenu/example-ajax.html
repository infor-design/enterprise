<div class="row">
  <div class="six colums">
    <h2>Popupmenu Example: Populated By AJAX</h2>
    <p>
      Related JIRA Ticket: <a class="hyperlink" href="https://jira.infor.com/browse/SOHO-6940" target="_blank">SOHO-6940</a>
    </p>
    <p>
      In this example, both the top-level and submenus are populated via AJAX calls.
    </p>
  </div>
</div>

<div class="row">
  <div class="six columns">

    <button id="targetButton" class="btn-menu">
      <span>Open Menu</span>
    </button>
    <ul id="popup-menu" class="popupmenu"></ul>

  </div>
</div>

<script>
  var MENU_RESPONSE_HTML = '' +
    '<li><a href="#">Item One</a></li>' +
    '<li><a href="#">Item Two</a></li>' +
    '<li class="submenu">' +
      '<a href="#">Item Three</a>' +
      '<ul class="popupmenu"></ul>' +
    '</li>' +
    '<li><a href="#">Item Four</a></li>' +
  '';

  var SUBMENU_RESPONSE_HTML = '' +
    '<li><a href="#">Sub-item One</a></li>' +
    '<li><a href="#">Sub-item Two</a></li>' +
    '<li><a href="#">Sub-item Three</a></li>' +
    '<li><a href="#">Sub-item Four</a></li>' +
  '';


  function popupmenuTestBeforeOpen(response, options) {
    if (options.contextElement) {
      setTimeout(function() {
        response(SUBMENU_RESPONSE_HTML);
      }, 100);
      return;
    }

    setTimeout(function() {
      response(MENU_RESPONSE_HTML);
    }, 100);
  }

  $('#targetButton').popupmenu({
    beforeOpen: popupmenuTestBeforeOpen,
    menu: 'popup-menu',
    attributes: [
      {
        name: 'data-automation-id',
        value: 'test'
      }
    ]
  });
</script>
